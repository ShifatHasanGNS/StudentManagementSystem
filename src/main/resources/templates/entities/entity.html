<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title th:text="${entityType} + (mode=='form' ? ' - Form' : ' - View')">Entity</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" th:href="@{/css/compact.css}" />
</head>

<body>
    <div th:replace="~{fragments/navbar :: navbar}"></div>

    <div class="container mt-4">
        <div class="card">
            <div class="card-body">

                <!-- FORM MODE -->
                <div th:if="${mode == 'form'}">
                    <h3 th:text="${entityType} + ' Form'">Form</h3>
                    <form th:action="${saveUrl}" method="post" th:object="${entity}">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                        <input type="hidden" th:if="${entity.id != null}" th:field="*{id}" />

                        <div class="mb-3" th:if="${entityType == 'student' or entityType == 'teacher'}">
                            <label class="form-label">First Name</label>
                            <input class="form-control" th:field="*{firstName}" />
                        </div>

                        <div class="mb-3" th:if="${entityType == 'student' or entityType == 'teacher'}">
                            <label class="form-label">Last Name</label>
                            <input class="form-control" th:field="*{lastName}" />
                        </div>

                        <div class="mb-3" th:if="${entityType == 'student' or entityType == 'teacher'}">
                            <label class="form-label">Email</label>
                            <input class="form-control" th:field="*{email}" />
                        </div>

                        <div class="mb-3" th:if="${entityType == 'student'}">
                            <label class="form-label">Student ID</label>
                            <input class="form-control" th:field="*{studentId}" />
                        </div>

                        <div class="mb-3" th:if="${entityType == 'teacher'}">
                            <label class="form-label">Employee ID</label>
                            <input class="form-control" th:field="*{employeeId}" />
                        </div>

                        <div class="row g-3">
                            <div class="col-md-6" th:if="${departments != null}">
                                <label class="form-label">Department</label>
                                <select class="form-control" th:field="*{department.id}">
                                    <option th:each="d : ${departments}" th:value="${d.id}" th:text="${d.name}"
                                        th:selected="${entity.department?.id == d.id}"></option>
                                </select>
                            </div>

                            <div class="col-md-6" th:if="${teachers != null}">
                                <label class="form-label">Teacher</label>
                                <select class="form-control" th:field="*{teacher.id}">
                                    <option th:each="t : ${teachers}" th:value="${t.id}"
                                        th:text="${t.firstName + ' ' + t.lastName}"
                                        th:selected="${entity.teacher?.id == t.id}"></option>
                                </select>
                            </div>
                        </div>

                        <div th:if="${entityType == 'course'}" class="mt-3">
                            <div class="mb-3">
                                <label class="form-label">Code</label>
                                <input class="form-control" th:field="*{code}" />
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Name</label>
                                <input class="form-control" th:field="*{name}" />
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Description</label>
                                <textarea class="form-control" th:field="*{description}"></textarea>
                            </div>
                        </div>

                        <div class="mt-4 d-flex gap-2">
                            <button type="submit" class="btn btn-primary">Save</button>
                            <a th:href="${listUrl}" class="btn btn-outline-secondary">Cancel</a>
                        </div>
                    </form>
                </div>

                <!-- VIEW MODE -->
                <div th:if="${mode == 'view'}">
                    <h3 th:text="${entityType} + ' Details'">Details</h3>

                    <div class="mb-2"
                        th:if="${(entityType == 'student' or entityType == 'teacher') and entity.firstName != null}">
                        <strong>First Name:</strong> <span th:text="${entity.firstName}"></span>
                    </div>
                    <div class="mb-2"
                        th:if="${(entityType == 'student' or entityType == 'teacher') and entity.lastName != null}">
                        <strong>Last Name:</strong> <span th:text="${entity.lastName}"></span>
                    </div>
                    <div class="mb-2"
                        th:if="${(entityType == 'student' or entityType == 'teacher') and entity.email != null}">
                        <strong>Email:</strong> <span th:text="${entity.email}"></span>
                    </div>
                    <div class="mb-2" th:if="${entityType == 'student' and entity.studentId != null}">
                        <strong>Student ID:</strong> <span th:text="${entity.studentId}"></span>
                    </div>
                    <div class="mb-2" th:if="${entityType == 'teacher' and entity.employeeId != null}">
                        <strong>Employee ID:</strong> <span th:text="${entity.employeeId}"></span>
                    </div>
                    <div class="mb-2" th:if="${entity.code != null}">
                        <strong>Code:</strong> <span th:text="${entity.code}"></span>
                    </div>
                    <div class="mb-2" th:if="${entity.description != null}">
                        <strong>Description:</strong> <span th:text="${entity.description}"></span>
                    </div>
                    <div class="mb-2" th:if="${entity.department != null}">
                        <strong>Department:</strong> <span th:text="${entity.department.name}"></span>
                    </div>
                    <div class="mb-2" th:if="${entity.teacher != null}">
                        <strong>Teacher:</strong> <span
                            th:text="${entity.teacher.firstName + ' ' + entity.teacher.lastName}"></span>
                    </div>

                    <div class="mt-4 d-flex gap-2">
                        <a th:href="${listUrl}" class="btn btn-secondary">Back</a>
                        <a th:href="${editUrl}" class="btn btn-warning" th:if="${editUrl != null}">Edit</a>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>